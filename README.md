# Hackaton 19.04.24 (backend)

## Запуск:
```bash
sudo docker-compose up --build
```


## GET запросы:

### 1. Получение списка всех команд

**Метод:** `GET`  
**Путь:** `/teams/`  
**Описание:** Возвращает список всех команд.  
**Требуемые заголовки:**
- `token`: Токен для аутентификации пользователя. (* необязательно)   
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает список объектов команд в формате JSON, каждый объект содержит информацию о команде.
**Пример успешного ответа:**
```json
{
  "teams": [
    {
      "slug": "название_команды",
      "icon_path": "путь_к_иконке_команды"
    },
    ...
  ],
  "ranked_teams": [
    "название_команды_с_рейтингом",
    ...
  ]
}
```

### 2. Получение данных о конкретной команде (`GET /teams/{slug}`)

Этот запрос возвращает данные о конкретной команде на основе её слага. В ответ на успешный запрос вы получите объект данных о команде в формате JSON. Объект содержит информацию о названии команды, слаге, электронной почте, пути к иконке команды, а также списки участников команды, вопросов и рейтингов.

```json
{
  "name": "название_команды",
  "slug": "слаг_команды",
  "email": "email@команды",
  "icon_path": "путь_к_иконке_команды",
  "team_users": [
    {
      "surname": "Фамилия участника",
      "first_name": "Имя участника",
      "patronymic": "Отчество участника",
      "image": "base64 строка с изображением",
      "description": "Описание участника",
      "job": "Профессия - ui/ux дизайнер",
      "mark_participation": 3,
      "difficulties": "Трудности возникшие в проекте",
      "portfolio_link": "https://portfolio.link"
    },
    ...
  ],
  "questions": []
}
```

### 3. Получение списка типов рейтингов

**Метод:** `GET`  
**Путь:** `/ratings/types/`  
**Описание:** Возвращает список доступных типов рейтингов.  
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает список объектов типов рейтингов в формате JSON.     
**Пример успешного ответа:**
```json
[
  {
    "slug": "design",
    "name": "Дизайн"
  },
  {
    "slug": "usability",
    "name": "Юзабилити"
  },
  {
    "slug": "layout",
    "name": "Верстка"
  },
  {
    "slug": "implementation",
    "name": "Реализация"
  }
]
```

### 4. Получение рейтингов команд

**Метод:** `GET`  
**Путь:** `/ratings/`  
**Описание:** Возвращает рейтинги всех команд.  
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает список объектов рейтингов команд в формате JSON.  

**Пример успешного ответа:**
```json
[
  {
    "command_slug": "слаг_команды",
    "ratings": {
      "design": 4,
      "usability": 4,
      "layout": 5,
      "implementation": 3
    },
    "mean_mark": 4,
    "sum_marks": 16
  },
  {
    "command_slug": "слаг_команды2",
    "ratings": {
      "design": "-",
      "usability": "-",
      "layout": "-",
      "implementation": "-"
    },
    "mean_mark": "-",
    "sum_marks": 0
  },
  ...
]
```

----


## POST запросы

## POST Запросы:

### 1. Обновление данных команды

**Метод:** `POST`  
**Путь:** `/teams/{slug}`  
**Описание:** Обновляет данные о команде по её слагу.  
**Требуемые заголовки:**
- `token`: Токен для аутентификации пользователя.  

**Параметры пути:**
- `{slug}`: Слаг команды, данные которой нужно обновить.  

**Тело запроса (JSON):**
```json
{
  "email": "новый_email@команды",
  "team_name": "новое_название_команды",
  "login": "новый_логин_команды",
  "image": "новое_изображение_команды",
  "team_users": [
    {
      "id": 1,
      "surname": "новая_фамилия",
      "first_name": "новое_имя",
      "patronymic": "новое_отчество",
      "description": "новое_описание",
      "image": "новое_изображение_участника",
      "job": "новая_работа",
      "mark_participation": "новая_оценка_участия",
      "difficulties": "новые_сложности",
      "portfolio_link": "новая_ссылка_на_портфолио"
    },
    ...
  ]
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает сообщение об успешном обновлении данных команды.
- `401 Unauthorized`: Некорректный токен аутентификации.
- `404 Not Found`: Команда не найдена.  
**Пример успешного ответа:**
```json
{
  "detail": "Team updated successfully"
}
```

### 2. Регистрация новой команды

**Метод:** `POST`  
**Путь:** `/teams/`  
**Описание:** Регистрирует новую команду.  
**Тело запроса (JSON):**
```json
{
  "team_name": "название_команды",
  "email": "email@команды",
  "login": "логин_команды",
  "password": "пароль_команды",
  "image": "изображение_команды",
  "team_users": [
    {
      "surname": "фамилия_участника",
      "first_name": "имя_участника",
      "patronymic": "отчество_участника",
      "description": "описание_участника",
      "image": "изображение_участника",
      "job": "работа_участника", # необязательное
      "mark_participation": "оценка_участия_участника", # необязательное
      "difficulties": "сложности_участника", # необязательное
      "portfolio_link": "ссылка_на_портфолио_участника" # необязательное
    },
    ...
  ]
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает токен аутентификации и слаг созданной команды.
- `400 Bad Request`: Некорректные данные запроса.  

**Пример успешного ответа:**
```json
{
  "token": "сгенерированный_токен",
  "slug": "слаг_новой_команды"
}
```

### 3. Регистрация нового участника команды

**Метод:** `POST`  
**Путь:** `/teams/{slug}/users/`  
**Описание:** Регистрирует нового участника в команде.  
**Параметры пути:**
- `{slug}`: Слаг команды, в которую добавляется новый участник.  

**Тело запроса (JSON):**
```json
{
  "surname": "фамилия_участника",
  "first_name": "имя_участника",
  "patronymic": "отчество_участника",
  "description": "описание_участника",
  "image": "изображение_участника",
  "job": "работа_участника", # необязательное
  "mark_participation": "оценка_участия_участника", # необязательное
  "difficulties": "сложности_участника", # необязательное
  "portfolio_link": "ссылка_на_портфолио_участника" # необязательное
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает данные о добавленном участнике команды.
- `404 Not Found`: Команда не найдена.  

**Пример успешного ответа:**
```json
{
  "id": 1,
  "surname": "фамилия_участника",
  "first_name": "имя_участника",
  "patronymic": "отчество_участника",
  "img_path": "путь_к_изображению_участника",
  "description": "описание_участника",
  "job": "работа_участника", # необязательное
  "mark_participation": "оценка_участия_участника", # необязательное
  "difficulties": "сложности_участника", # необязательное
  "portfolio_link": "ссылка_на_портфолио_участника", # необязательное
  "team_id": "идентификатор_команды"
}
```

### 4. Аутентификация пользователя

**Метод:** `POST`  
**Путь:** `/login/`  
**Описание:** Проверяет аутентификационные данные пользователя и выдает токен для доступа.  
**Тело запроса (JSON):**
```json
{
  "login": "логин_пользователя",
  "password": "пароль_пользователя"
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает токен аутентификации и слаг команды пользователя.
- `400 Bad Request`: Некорректные аутентификационные данные.  

**Пример успешного ответа:**
```json
{
  "token": "сгенерированный_токен",
  "slug":

 "слаг_команды"
}
```

### 5. Добавление рейтингов для команды

**Метод:** `POST`  
**Путь:** `/ratings/{slug}`  
**Описание:** Добавляет рейтинги для команды по её слагу.  
**Требуемые заголовки:**
- `token`: Токен для аутентификации пользователя.  

**Параметры пути:**
- `{slug}`: Слаг команды, для которой добавляются рейтинги.  

**Тело запроса (JSON):**
```json
{
  "command_slug": "слаг_команды_отправителя",
  "ratings": {
    "design": 4.5,
    "usability": 3.8,
    "layout": 4.2,
    "implementation": 4.0
  }
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает сообщение об успешном добавлении рейтингов.
- `401 Unauthorized`: Некорректный токен аутентификации.
- `400 Bad Request`: Некорректные данные запроса (слаг команды не верный). 

**Пример успешного ответа:**
```json
{
  "detail": "Ratings added successfully"
}
```
